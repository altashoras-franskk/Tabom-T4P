import{p as a,a as c}from"./index-9jorbohS.js";const r=`https://${a}.supabase.co/functions/v1/make-server-0834700c`;function t(){const e="rhizome_device_id";let o=localStorage.getItem(e);return o||(o=`device_${Date.now()}_${Math.random().toString(36).slice(2,11)}`,localStorage.setItem(e,o)),o}function i(){return localStorage.getItem("rhizome_access_token")}function h(e){e?localStorage.setItem("rhizome_access_token",e):localStorage.removeItem("rhizome_access_token")}function n(){return{Authorization:`Bearer ${i()||c}`,"Content-Type":"application/json"}}async function l(){try{const e=t(),o=await fetch(`${r}/rhizome/folders/${e}`,{method:"GET",headers:n()});return o.ok?(await o.json()).folders||[]:[]}catch(e){return console.error("Error loading folders from backend:",e),[]}}async function m(e){try{const o=t();return(await fetch(`${r}/rhizome/folders/${o}`,{method:"POST",headers:n(),body:JSON.stringify({folders:e})})).ok}catch(o){return console.error("Error saving folders to backend:",o),!1}}async function f(){try{const e=t(),o=await fetch(`${r}/rhizome/saved/${e}`,{method:"GET",headers:n()});return o.ok?(await o.json()).rhizomes||[]:[]}catch(e){return console.error("Error loading rhizomes from backend:",e),[]}}async function u(e){try{const o=t();return(await fetch(`${r}/rhizome/saved/${o}`,{method:"POST",headers:n(),body:JSON.stringify({rhizomes:e})})).ok}catch(o){return console.error("Error saving rhizomes to backend:",o),!1}}export{i as getStoredToken,l as loadFoldersFromBackend,f as loadRhizomesFromBackend,m as saveFoldersToBackend,u as saveRhizomesToBackend,h as setStoredToken};
